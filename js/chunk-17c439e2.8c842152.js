(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-17c439e2"],{8486:function(e,t,i){"use strict";var s=i("966a"),o=i.n(s);o.a},"966a":function(e,t,i){},b7e8:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"sflow-design"}},[i("s-flow",{staticStyle:{height:"600px"},attrs:{name:"自定义流程名",nodes:e.nodes,links:e.links,items:e.items,tools:e.tools,path:e.path,"node-class":function(e){return e.type},"link-class":function(e){return e.type},"sub-size":e.subSize},on:{nodeClick:e.nodeClick,nodeCreate:e.nodeCreate,nodeDblclick:e.nodeDblclick,toolClick:e.toolClick}})],1)},o=[],n=i("ec26"),a={data(){return{flowMap:{},flowHistory:[],flowIndex:0,rootFlow:{id:"node-0",name:"子流程示例",sub:{nodes:[{id:"node-1",name:"开始",type:"StartNoneEvent",icon:"caret-right",x:80,y:80,w:80,h:40},{id:"node-2",name:"请假申请",type:"SubProcess",icon:"appstore",x:220,y:200,w:400,h:200,sub:{nodes:[{id:"node-1",name:"开始",type:"StartNoneEvent",icon:"caret-right",x:20,y:80,w:80,h:40},{id:"node-2",name:"领导签字",type:"UserTask",icon:"user",x:140,y:80,w:80,h:40},{id:"node-3",name:"结束",type:"StartNoneEvent",icon:"stop",x:260,y:80,w:80,h:40}],links:[{id:"link-1",name:"he",way:"h",s:"node-1",t:"node-2"},{id:"link-2",name:"ha",way:"h",s:"node-2",t:"node-3"}]}},{id:"node-3",name:"领导审批",type:"UserTask",icon:"thunderbolt",x:670,y:100,w:120,h:40},{id:"node-4",name:"请假时间",type:"InclusiveGateway",icon:"clock-circle",x:650,y:400,w:120,h:60},{id:"node-5",name:"结束",type:"EndNoneEvent",icon:"stop",x:840,y:40,w:80,h:40}],links:[{id:"link-1",name:"ddsada",way:"v",s:"node-1",t:"node-2"},{id:"link-2",name:"ta",way:"h",s:"node-2",t:"node-3"},{id:"link-3",name:"ta",way:"l",s:"node-3",t:"node-4"},{id:"link-4",name:"at",way:"l",s:"node-4",t:"node-3"}]}},rootItems:[{id:"items-1",name:"开始",icon:"caret-right",type:"StartNoneEvent"},{id:"items-2",name:"定时开始",icon:"clock-circle",type:"StartTimerEvent"},{id:"items-3",name:"结束",icon:"stop",type:"EndNoneEvent"},{id:"items-4",name:"用户任务",icon:"user",type:"UserTask"},{id:"items-5",name:"服务任务",icon:"setting",type:"ServiceTask"},{id:"items-6",name:"子流程",icon:"appstore",type:"SubProcess"},{id:"items-7",name:"条件分支",icon:"fork",type:"InclusiveGateway"},{id:"items-8",name:"互斥分支",icon:"fork",type:"ExclusiveGateway"},{id:"items-9",name:"分支聚合",icon:"fork",type:"ParallelGateway"},{id:"items-10",name:"定时边界事件",icon:"link",type:"BoundaryTimerEvent"},{id:"items-11",name:"区域",icon:"gateway",type:"Area"}],subItems:[{id:"items-1",name:"开始",icon:"caret-right",type:"StartNoneEvent"},{id:"items-2",name:"结束",icon:"stop",type:"EndNoneEvent"},{id:"items-3",name:"用户任务",icon:"user",type:"UserTask"},{id:"items-4",name:"服务任务",icon:"setting",type:"ServiceTask"},{id:"items-5",name:"子流程",icon:"appstore",type:"SubProcess"}],items:[],nodes:[],tools:[{name:"新增",icon:"file"},{name:"保存",icon:"save"},{name:"文本注释",icon:"message",type:"comment"}],path:[],gobackTool:{name:"后退",icon:"left",type:"goback",disabled:!0},forwardTool:{name:"前进",icon:"right",type:"forward",disabled:!0},links:[],activeNode:null,subSize:null}},created(){this.nodes=this.rootFlow.sub.nodes,this.links=this.rootFlow.sub.links,this.items=this.rootItems,this.flowMap[this.rootFlow.id]=this.rootFlow,this.flowHistory.push(this.rootFlow.id),this.path=[{id:this.rootFlow.id,name:this.rootFlow.name}],this.tools=[this.gobackTool,this.forwardTool,...this.tools]},watch:{flowIndex(e){this.gobackTool.disabled=0===e,this.forwardTool.disabled=e===this.flowHistory.length-1}},methods:{toolClick(e){if("goback"===e.type){this.flowIndex=this.flowIndex-1;const e=this.flowHistory[this.flowIndex],t=this.flowMap[e];this.nodes=t.sub.nodes,this.links=t.sub.links,"SubProcess"===t.type?(this.items=this.subItems,this.subSize={w:t.w-30,h:t.h}):(this.items=this.rootItems,this.subSize=null),this.path=this._getPath(this.rootFlow,e)}else if("forward"===e.type){this.flowIndex=this.flowIndex+1;const e=this.flowHistory[this.flowIndex],t=this.flowMap[e];this.nodes=t.sub.nodes,this.links=t.sub.links,"SubProcess"===t.type?(this.items=this.subItems,this.subSize={w:t.w-30,h:t.h}):(this.items=this.rootItems,this.subSize=null),this.path=this._getPath(this.rootFlow,e)}else"comment"===e.type&&(null===this.activeNode?alert("请选择添加注释的节点"):this.addComment())},nodeClick(e){this.activeNode=e},nodeCreate(e){"SubProcess"===e.type&&(e.w=400,e.h=200,e.sub={nodes:[],links:[]})},nodeDblclick(e){"SubProcess"===e.type&&(this.nodes=e.sub.nodes,this.links=e.sub.links,this.items=this.subItems,this.subSize={w:e.w-30,h:e.h},this.flowMap[e.id]=e,this.path=this._getPath(this.rootFlow,e.id),this.flowHistory=[...this.flowHistory.slice(0,this.flowIndex+1),e.id],this.flowIndex=this.flowIndex+1)},_getPath(e,t){if(e.id===t)return[{id:e.id,name:e.name}];if(e.sub){const i=[];return e.sub.nodes.forEach(e=>{i.push(...this._getPath(e,t))}),[{id:e.id,name:e.name},...i]}return[]},addComment(){const e="node_"+Object(n["a"])().replace(/-/g,"");this.nodes.push({id:e,x:this.activeNode.x+150,y:this.activeNode.y-60,w:100,h:40,name:"详细注释",type:"TextAnnotation",icon:"message"}),this.links.push({id:"link_"+Object(n["a"])().replace(/-/g,""),way:"l",s:e,type:"comment-link",t:this.activeNode.id})}}},d=a,l=(i("8486"),i("2877")),h=Object(l["a"])(d,s,o,!1,null,null,null);t["default"]=h.exports}}]);